<!DOCTYPE html>
<html lang="en">
<head>
  <title>OpTiMSoC User Guide</title>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  <!-- external CSS -->
  <link href="//netdna.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">

  <!-- our own CSS (must be include after bootstrap.css!) -->
  <link rel="stylesheet" href="/css/optimsoc.css"/>

  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
    <script src="/js/html5shiv.js"></script>
    <script src="/js/respond.min.js"></script>
  <![endif]-->

  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" />

  <!-- Google Web Fonts -->
  <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,400italic,600,700,900" rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro:400,500,600,700" rel="stylesheet" type="text/css">
  <link href="//fonts.googleapis.com/css?family=Fredericka+the+Great" rel="stylesheet" type="text/css">
</head>
<body  data-offset='50' data-spy="scroll" data-target="">
  <!-- top navigation bar -->
  <nav class="navbar navbar-fixed-top optimsoc-nav" role="navigation">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/index.html" alt="OpTiMSoC"><span class="wordmark">OpTiMSoC</span></a>
      </div>
      <div class="navbar-collapse collapse">
        <ul class="nav navbar-nav">
          <li><a href="/download.html">Download</a></li>
          <li><a href="/docs/index.html">Documentation</a></li>
          <li><a href="/getinvolved.html">Get involved</a></li>
          <li><a href="/about.html">About</a></li>
          <li><a href="/blog">Blog</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container" id="maincontent">
  
  <div class="optimsoc-section-header">
    <h1>User Guide</h1>
  </div>
  <hr/>
  

      <div class="col-md-3"><div class="optimsoc-doc-mainnav" data-spy="affix" data-offset-top="50">
<div style="padding-bottom:10px">
          version 2015.1

          (<a href="/docs/index.html#document-archive">other versions</a>)
        </div>
<ul class="nav">
<li><a href="chap_introduction.html" title="Chapter&nbsp;1 Introduction &#8227; OpTiMSoC User Guide">Introduction</a></li>
<li><a href="chap_installation.html" title="Chapter&nbsp;2 Installation &amp; Configuration &#8227; OpTiMSoC User Guide">Installation &amp; Configuration</a></li>
<li class="active">
<div class="active">Tutorials</div>
<div id="optimsoc-doc-subnav-nav" class="optimsoc-doc-subnav hidden-print" role="complementary"><ul class="nav">
<li class=""><a href="#S1" title="3.1 Starting Small: Compute Tile and Software (Simulated) &#8227; Chapter&nbsp;3 Tutorials &#8227; OpTiMSoC User Guide">Starting Small: Compute Tile and Software (Simulated)</a></li>
<li class=""><a href="#S2" title="3.2 Going Multicore: Simulate Multicore Compute Tiles &#8227; Chapter&nbsp;3 Tutorials &#8227; OpTiMSoC User Guide">Going Multicore: Simulate Multicore Compute Tiles</a></li>
<li class=""><a href="#S3" title="3.3 Tiled Manycore SoC: Simulate a Small 2x2 Distributed Memory
System &#8227; Chapter&nbsp;3 Tutorials &#8227; OpTiMSoC User Guide">Tiled Manycore SoC: Simulate a Small 2x2 Distributed Memory
System</a></li>
<li class=""><a href="#S4" title="3.4 The Look Inside: Introducing the Debug System &#8227; Chapter&nbsp;3 Tutorials &#8227; OpTiMSoC User Guide">The Look Inside: Introducing the Debug System</a></li>
<li class=""><a href="#S5" title="3.5 Verilator: Compiled Verilog simulation &#8227; Chapter&nbsp;3 Tutorials &#8227; OpTiMSoC User Guide">Verilator: Compiled Verilog simulation</a></li>
<li class=""><a href="#S6" title="3.6 Going to the FPGA: ZTEX Boards &#8227; Chapter&nbsp;3 Tutorials &#8227; OpTiMSoC User Guide">Going to the FPGA: ZTEX Boards</a></li>
</ul></div>
</li>
<li><a href="Ch4.html" title="Chapter&nbsp;4 Develop OpTiMSoC &#8227; OpTiMSoC User Guide">Develop OpTiMSoC</a></li>
</ul>
</div></div><div class="col-md-9 optimsoc-doc-body">
<div class="ltx_page_main">
<div class="ltx_page_content">
<section class="ltx_chapter">
<h1 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">Chapter&nbsp;3 </span>Tutorials</h1>
<div class="ltx_date ltx_role_creation"></div>

<div id="p1" class="ltx_para">
<p class="ltx_p">The best way to get started with OpTiMSoC after you&rsquo;ve prepared your
system as described in the previous chapter is to follow some of our
tutorials. They are written with two goals in mind: to introduce some
of the basic concepts and nomenclature of manycore SoC, and to show
you how those are implemented and can be used in OpTiMSoC.</p>
</div>
<div id="p2" class="ltx_para">
<p class="ltx_p">Some of the tutorials (especially the first ones) build on top of each
other, so it&rsquo;s recommended to do them in order. Simply stop if you
think you know enough to implement your own ideas!</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3.1 </span>Starting Small: Compute Tile and Software (Simulated)</h2>

<div id="S1.p1" class="ltx_para">
<p class="ltx_p">It is a good starting point to simulate a single compute tile of a
distributed memory system. Therefore a simple example is included and
demonstrates the general simulation approach and gives an insight in
the software building process.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p class="ltx_p">Simulating only a single compute tile is essentially an OpenRISC core
plus memory and the network adapter, where all I/O of the network
adapter is not functional in this test case. It can therefore only be
used to simulate local software.
</p>
</div>
<div id="S1.p3" class="ltx_para">
<p class="ltx_p">You can find this example in
<span class="ltx_ref ltx_path ltx_ref_self"><span class="ltx_text ltx_font_typewriter">$OPTIMSC/examples/dm/compute_tile</span></span>.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p class="ltx_p">In default mode they start a server to connect the host software to,
but you can use the parameter <code class="ltx_verbatim ltx_font_typewriter">--standalone</code> to run them in
standalone. If you start the simulation now</p>
</div>
<div id="S1.p5" class="ltx_para">
<div id="LSTx9" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,%24OPTIMSOC/examples/dm/compute_tile/tb_compute_tile%20--standalone">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">$OPTIMSOC/examples/dm/compute_tile/tb_compute_tile<span class="ltx_text ltx_lst_space">&nbsp;</span>--standalone</span>
              </td>
</tr>
</table>
</div>
</div>
<div id="S1.p6" class="ltx_para">
<p class="ltx_p">you will get this output</p>
</div>
<div id="S1.p7" class="ltx_para">
<div id="LSTx10" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,%Error:%20ct.vmem:0:%20%24readmem%20file%20not%20found%0AAborting...%0AAborted%20(core%20dumped)">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">%Error:<span class="ltx_text ltx_lst_space">&nbsp;</span>ct.vmem:0:<span class="ltx_text ltx_lst_space">&nbsp;</span>$readmem<span class="ltx_text ltx_lst_space">&nbsp;</span>file<span class="ltx_text ltx_lst_space">&nbsp;</span>not<span class="ltx_text ltx_lst_space">&nbsp;</span>found</span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">Aborting...</span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">Aborted<span class="ltx_text ltx_lst_space">&nbsp;</span>(core<span class="ltx_text ltx_lst_space">&nbsp;</span>dumped)</span>
              </td>
</tr>
</table>
</div>
</div>
<div id="S1.p8" class="ltx_para">
<p class="ltx_p">The simulations always expect vmem files that initialize the memories.
This needs to be generated from the compiled source code.</p>
</div>
<div id="S1.p9" class="ltx_para">
<p class="ltx_p">Our demonstration software is available in an extra repository:</p>
</div>
<div id="S1.p10" class="ltx_para">
<div id="LSTx11" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,git%20clone%20https://github.com/optimsoc/baremetal-apps%0Acd%20baremetal-apps">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">git<span class="ltx_text ltx_lst_space">&nbsp;</span>clone<span class="ltx_text ltx_lst_space">&nbsp;</span>https://github.com/optimsoc/baremetal-apps</span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">cd<span class="ltx_text ltx_lst_space">&nbsp;</span>baremetal-apps</span>
              </td>
</tr>
</table>
</div>
</div>
<div id="S1.p11" class="ltx_para">
<p class="ltx_p">Build a simple &ldquo;Hello World&rdquo; example:</p>
</div>
<div id="S1.p12" class="ltx_para">
<div id="LSTx12" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,cd%20hello%0Amake">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">cd<span class="ltx_text ltx_lst_space">&nbsp;</span>hello</span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">make</span>
              </td>
</tr>
</table>
</div>
</div>
<div id="S1.p13" class="ltx_para">
<p class="ltx_p">You will then find the executable elf file as <span class="ltx_ref ltx_path ltx_ref_self"><span class="ltx_text ltx_font_typewriter">hello/hello.elf</span></span>.
Furthermore some other files are build:</p>
</div>
<div id="S1.p14" class="ltx_para">
<ul id="I1" class="ltx_itemize">
<li id="I1.i1" class="ltx_item">
<div id="I1.i1.p1" class="ltx_para">
<p class="ltx_p"><code class="ltx_verbatim ltx_font_typewriter">hello.dis</code> is the disassembly of the file</p>
</div>
</li>
<li id="I1.i2" class="ltx_item">
<div id="I1.i2.p1" class="ltx_para">
<p class="ltx_p"><code class="ltx_verbatim ltx_font_typewriter">hello.bin</code> is the elf representation of the binary file</p>
</div>
</li>
<li id="I1.i3" class="ltx_item">
<div id="I1.i3.p1" class="ltx_para">
<p class="ltx_p"><code class="ltx_verbatim ltx_font_typewriter">hello.vmem</code> is a textual copy of the binary file</p>
</div>
</li>
</ul>
</div>
<div id="S1.p15" class="ltx_para">
<p class="ltx_p">You can now run the example again, this time with a different memory
initialization file:</p>
</div>
<div id="S1.p16" class="ltx_para">
<div id="LSTx13" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,%24OPTIMSOC/examples/dm/compute_tile/tb_compute_tile%20--standalone%20--meminit=hello.vmem">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">$OPTIMSOC/examples/dm/compute_tile/tb_compute_tile<span class="ltx_text ltx_lst_space">&nbsp;</span>--standalone<span class="ltx_text ltx_lst_space">&nbsp;</span>--meminit=hello.vmem</span>
              </td>
</tr>
</table>
</div>
</div>
<div id="S1.p17" class="ltx_para">
<p class="ltx_p">the simulation should terminate with:</p>
</div>
<div id="S1.p18" class="ltx_para">
<div id="LSTx14" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,%5B157801%5D%20Core%200%20has%20terminated%0A%5B157801%5D%20All%20cores%20terminated.%20Exiting..">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">[157801]<span class="ltx_text ltx_lst_space">&nbsp;</span>Core<span class="ltx_text ltx_lst_space">&nbsp;</span>0<span class="ltx_text ltx_lst_space">&nbsp;</span>has<span class="ltx_text ltx_lst_space">&nbsp;</span>terminated</span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">[157801]<span class="ltx_text ltx_lst_space">&nbsp;</span>All<span class="ltx_text ltx_lst_space">&nbsp;</span>cores<span class="ltx_text ltx_lst_space">&nbsp;</span>terminated.<span class="ltx_text ltx_lst_space">&nbsp;</span>Exiting..</span>
              </td>
</tr>
</table>
</div>
</div>
<div id="S1.p19" class="ltx_para">
<p class="ltx_p">Furthermore, you will find a file called <code class="ltx_verbatim ltx_font_typewriter">stdout.000</code> which shows
the actual output:</p>
</div>
<div id="S1.p20" class="ltx_para">
<div id="LSTx15" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,Hello%20World!%20Core%200%20of%201%20in%20tile%200,%20my%20absolute%20core%20id%20is:%200%0AThere%20are%201%20compute%20tiles:%0A%20rank%200%20is%20tile%200">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">Hello<span class="ltx_text ltx_lst_space">&nbsp;</span>World!<span class="ltx_text ltx_lst_space">&nbsp;</span>Core<span class="ltx_text ltx_lst_space">&nbsp;</span>0<span class="ltx_text ltx_lst_space">&nbsp;</span>of<span class="ltx_text ltx_lst_space">&nbsp;</span>1<span class="ltx_text ltx_lst_space">&nbsp;</span>in<span class="ltx_text ltx_lst_space">&nbsp;</span>tile<span class="ltx_text ltx_lst_space">&nbsp;</span>0,<span class="ltx_text ltx_lst_space">&nbsp;</span>my<span class="ltx_text ltx_lst_space">&nbsp;</span>absolute<span class="ltx_text ltx_lst_space">&nbsp;</span>core<span class="ltx_text ltx_lst_space">&nbsp;</span>id<span class="ltx_text ltx_lst_space">&nbsp;</span>is:<span class="ltx_text ltx_lst_space">&nbsp;</span>0</span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">There<span class="ltx_text ltx_lst_space">&nbsp;</span>are<span class="ltx_text ltx_lst_space">&nbsp;</span>1<span class="ltx_text ltx_lst_space">&nbsp;</span>compute<span class="ltx_text ltx_lst_space">&nbsp;</span>tiles:</span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter"><span class="ltx_text ltx_lst_space">&nbsp;</span>rank<span class="ltx_text ltx_lst_space">&nbsp;</span>0<span class="ltx_text ltx_lst_space">&nbsp;</span>is<span class="ltx_text ltx_lst_space">&nbsp;</span>tile<span class="ltx_text ltx_lst_space"></span></span>
              </td>
</tr>
</table>
</div>
</div>
<div id="S1.p21" class="ltx_para">
<p class="ltx_p">But how does the actual printf-output get there when there is no UART
or similar?</p>
</div>
<div id="S1.p22" class="ltx_para">
<p class="ltx_p">OpTiMSoC software makes excessive use of a useful part of the OpenRISC ISA. The
&ldquo;no operation&rdquo; instruction <code class="ltx_verbatim ltx_font_typewriter">l.nop</code> has a parameter <code class="ltx_verbatim ltx_font_typewriter">K</code> in assembly.
This can be used for simulation purposes. It can be used for instrumentation,
tracing or special purposes as writing characters with minimal intrusion or
simulation termination.</p>
</div>
<div id="S1.p23" class="ltx_para">
<p class="ltx_p">The termination is forced with <code class="ltx_verbatim ltx_font_typewriter">l.nop 0x1</code>. The instruction is
observed and a trace monitor terminates when it was observed at all
cores (shortly after <code class="ltx_verbatim ltx_font_typewriter">main</code> returned).</p>
</div>
<div id="S1.p24" class="ltx_para">
<p class="ltx_p">With this method you can simply provide constants to your simulation
environments. For variables this method is extended by putting data in
further registers (often <code class="ltx_verbatim ltx_font_typewriter">r3</code>). This still is minimally intrusive
and allows you to trace values. The printf is also done that way (see
newlib):</p>
</div>
<div id="S1.p25" class="ltx_para">
<div id="LSTx16" class="ltx_listingblock ltx_lstlisting ltx_lst_language_C ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,void%20sim_putc(unsigned%20char%20c)%20%7B%0A%20%20asm(%22l.addi%5Ctr3,%0,0%22:%20:%22r%22%20(c));%0A%20%20asm(%22l.nop%20%0%22:%20:%22K%22%20(NOP_PUTC));%0A%7D">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter"><span class="ltx_text ltx_lst_keyword ltx_font_bold">void</span><span class="ltx_text ltx_lst_space">&nbsp;</span>sim_putc(<span class="ltx_text ltx_lst_keyword ltx_font_bold">unsigned</span><span class="ltx_text ltx_lst_space">&nbsp;</span><span class="ltx_text ltx_lst_keyword ltx_font_bold">char</span><span class="ltx_text ltx_lst_space">&nbsp;</span>c)<span class="ltx_text ltx_lst_space">&nbsp;</span>asm"l.addi\tr3,%0,0":<span class="ltx_text ltx_lst_space">&nbsp;</span>:"r"<span class="ltx_text ltx_lst_space">&nbsp;</span>(c));</span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter"><span class="ltx_text ltx_lst_space">&nbsp;&nbsp;</span>asm("l.nop<span class="ltx_text ltx_lst_space">&nbsp;</span>%0":<span class="ltx_text ltx_lst_space">&nbsp;</span>:"K"<span class="ltx_text ltx_lst_space">&nbsp;</span>(NOP_PUTC));</span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">}</span>
              </td>
</tr>
</table>
</div>
</div>
<div id="S1.p26" class="ltx_para">
<p class="ltx_p">This function is called from printf as write function. The trace
monitor captures theses characters and puts them to the stdout file.</p>
</div>
<div id="S1.p27" class="ltx_para">
<p class="ltx_p">You can easily add your own &ldquo;traces&rdquo; using a macro defined in
<span class="ltx_ref ltx_path ltx_ref_self"><span class="ltx_text ltx_font_typewriter">baremetal-libs/src/libbaremetal/include/optimsoc-baremetal.h</span></span>:
</p>
</div>
<div id="S1.p28" class="ltx_para">
<div id="LSTx17" class="ltx_listingblock ltx_lstlisting ltx_lst_language_C ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,#define%20OPTIMSOC_TRACE(id,v)%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5C%0A%20%20%20asm(%22l.addi%5Ctr3,%0,0%22:%20:%22r%22%20(v)%20:%20%22r3%22);%20%5C%0A%20%20%20asm(%22l.nop%20%0%22:%20:%22K%22%20(id));">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">define<span class="ltx_text ltx_lst_space">&nbsp;</span>OPTIMSOC_TRACE(id,v)<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>\</span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter"><span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;</span>asm("l.addi\tr3,%0,0":<span class="ltx_text ltx_lst_space">&nbsp;</span>:"r"<span class="ltx_text ltx_lst_space">&nbsp;</span>(v)<span class="ltx_text ltx_lst_space">&nbsp;</span>:<span class="ltx_text ltx_lst_space">&nbsp;</span>"r3");<span class="ltx_text ltx_lst_space">&nbsp;</span>\</span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter"><span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;</span>asm("l.nop<span class="ltx_text ltx_lst_space">&nbsp;</span>%0":<span class="ltx_text ltx_lst_space">&nbsp;</span>:"K"<span class="ltx_text ltx_lst_space">&nbsp;</span>(id));</span>
              </td>
</tr>
</table>
</div>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3.2 </span>Going Multicore: Simulate Multicore Compute Tiles</h2>

<div id="S2.p1" class="ltx_para">
<p class="ltx_p">Next you might want to build an actual multicore system. In a first
step, you can just start simulations of compute tiles with multiple
cores:</p>
</div>
<div id="S2.p2" class="ltx_para">
<div id="LSTx18" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,%24OPTIMSOC/examples/dm/compute_tile-dual/tb_compute_tile%20--standalone%20--meminit=hello.vmem%0A%24OPTIMSOC/examples/dm/compute_tile-quad/tb_compute_tile%20--standalone%20--meminit=hello.vmem%0A%24OPTIMSOC/examples/dm/compute_tile-octa/tb_compute_tile%20--standalone%20--meminit=hello.vmem">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">$OPTIMSOC/examples/dm/compute_tile-dual/tb_compute_tile<span class="ltx_text ltx_lst_space">&nbsp;</span>--standalone<span class="ltx_text ltx_lst_space">&nbsp;</span>--meminit=hello.vmem</span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">$OPTIMSOC/examples/dm/compute_tile-quad/tb_compute_tile<span class="ltx_text ltx_lst_space">&nbsp;</span>--standalone<span class="ltx_text ltx_lst_space">&nbsp;</span>--meminit=hello.vmem</span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">$OPTIMSOC/examples/dm/compute_tile-octa/tb_compute_tile<span class="ltx_text ltx_lst_space">&nbsp;</span>--standalone<span class="ltx_text ltx_lst_space">&nbsp;</span>--meminit=hello.vmem</span>
              </td>
</tr>
</table>
</div>
</div>
<div id="S2.p3" class="ltx_para">
<p class="ltx_p">You can observe, the simulation runs become longer. After each run,
inspect the <code class="ltx_verbatim ltx_font_typewriter">stdout.*</code> files.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3.3 </span>Tiled Manycore SoC: Simulate a Small 2x2 Distributed Memory
System</h2>

<div id="S3.p1" class="ltx_para">
<p class="ltx_p">Next we want to run an actual NoC-based tiled manycore system-on-chip,
with the examples you get <code class="ltx_verbatim ltx_font_typewriter">system_2x2_cccc</code>. The nomenclature in
all pre-packed systems first denotes the dimensions and then the
instantiated tiles, here <code class="ltx_verbatim ltx_font_typewriter">cccc</code> as four compute tiles.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p class="ltx_p">Execute it again to get the hello world experience:</p>
</div>
<div id="S3.p3" class="ltx_para">
<div id="LSTx19" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,%24OPTIMSOC/examples/dm/system_2x2_cccc/tb_system_2x2_cccc%20--standalone%20--meminit=hello.vmem">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">$OPTIMSOC/examples/dm/system_2x2_cccc/tb_system_2x2_cccc<span class="ltx_text ltx_lst_space">&nbsp;</span>--standalone<span class="ltx_text ltx_lst_space">&nbsp;</span>--meminit=hello.vmem</span>
              </td>
</tr>
</table>
</div>
</div>
<div id="S3.p4" class="ltx_para">
<p class="ltx_p">In our simulation all cores in the four tiles run the same
software. Before you shout &ldquo;that&rsquo;s boring:&rdquo; You can still write
different code depending on which tile and core the software is
executed. A couple of functions are useful for that:</p>
</div>
<div id="S3.p5" class="ltx_para">
<ul id="I2" class="ltx_itemize">
<li id="I2.i1" class="ltx_item">
<div id="I2.i1.p1" class="ltx_para">
<p class="ltx_p"><code class="ltx_verbatim ltx_font_typewriter">optimsoc_get_numct()</code>: The number of compute tiles in the system</p>
</div>
</li>
<li id="I2.i2" class="ltx_item">
<div id="I2.i2.p1" class="ltx_para">
<p class="ltx_p"><code class="ltx_verbatim ltx_font_typewriter">optimsoc_get_numtiles()</code>: The number of tiles (of any type) in
the system</p>
</div>
</li>
<li id="I2.i3" class="ltx_item">
<div id="I2.i3.p1" class="ltx_para">
<p class="ltx_p"><code class="ltx_verbatim ltx_font_typewriter">optimsoc_get_ctrank()</code>: Get the rank of this compute tile in this
system. Essentially this is just a number that uniquely identifies a
compute tile.</p>
</div>
</li>
</ul>
</div>
<div id="S3.p6" class="ltx_para">
<p class="ltx_p">There are more useful utility functions like those available, find them in the
file <span class="ltx_ref ltx_path ltx_ref_self"><span class="ltx_text ltx_font_typewriter">baremetal-libs/src/libbaremetal/include/optimsoc-baremetal.h</span></span>.</p>
</div>
<div id="S3.p7" class="ltx_para">
<p class="ltx_p">A simple application that uses those functions to do message passing between
the different tiles is <code class="ltx_verbatim ltx_font_typewriter">hello\_mpsimple</code>. This program uses
the simple message passing facilities of the network adapter to send messages.
All cores send a message to core 0. If all messages have been received, core 0
prints a message &ldquo;Received all messages. Hello World!&rdquo;.</p>
</div>
<div id="S3.p8" class="ltx_para">
<div id="LSTx20" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,cd%20../hello_mpsimple%0Amake%0A%24OPTIMSOC/examples/dm/system_2x2_cccc/tb_system_2x2_cccc%20--standalone%20--meminit=hello_mpsimple.vmem">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">cd<span class="ltx_text ltx_lst_space">&nbsp;</span>../hello_mpsimple</span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">make</span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">$OPTIMSOC/examples/dm/system_2x2_cccc/tb_system_2x2_cccc<span class="ltx_text ltx_lst_space">&nbsp;</span>--standalone<span class="ltx_text ltx_lst_space">&nbsp;</span>--meminit=hello_mpsimple.vmem</span>
              </td>
</tr>
</table>
</div>
</div>
<div id="S3.p9" class="ltx_para">
<p class="ltx_p">Have a look what the software does (you find the code in
<span class="ltx_ref ltx_path ltx_ref_self"><span class="ltx_text ltx_font_typewriter">$OPTIMSOC_APPS/baremetal/hello_mpsimple/hello_mpsimple.c</span></span>). Let&rsquo;s
first check the output of core 0.</p>
</div>
<div id="S3.p10" class="ltx_para">
<div id="LSTx21" class="ltx_listingblock ltx_lstlisting ltx_lst_language_sh ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,%24&gt;%20cat%20stdout.000%0AWait%20for%203%20messages%0AReceived%20all%20messages.%20Hello%20World!">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">$&gt;<span class="ltx_text ltx_lst_space">&nbsp;</span><span class="ltx_text ltx_lst_keyword ltx_font_bold">cat</span><span class="ltx_text ltx_lst_space">&nbsp;</span>stdout.000</span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">Wait<span class="ltx_text ltx_lst_space">&nbsp;</span><span class="ltx_text ltx_lst_keyword ltx_font_bold">for</span><span class="ltx_text ltx_lst_space">&nbsp;</span>3<span class="ltx_text ltx_lst_space">&nbsp;</span>messages</span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">Received<span class="ltx_text ltx_lst_space">&nbsp;</span>all<span class="ltx_text ltx_lst_space">&nbsp;</span>messages.<span class="ltx_text ltx_lst_space">&nbsp;</span>Hello<span class="ltx_text ltx_lst_space">&nbsp;</span>World!</span>
              </td>
</tr>
</table>
</div>
</div>
<div id="S3.p11" class="ltx_para">
<p class="ltx_p">Finally, let&rsquo;s have a quick glance at a more realistic application:
<code class="ltx_verbatim ltx_font_typewriter">heat_mpsimple</code>. You can find it in the same place as the previous
applications, <code class="ltx_verbatim ltx_font_typewriter">hello</code> and <code class="ltx_verbatim ltx_font_typewriter">hello_mpsimple</code>. The application
calculates the heat distribution in a distributed manner. The cores coordinate
their boundary regions by sending messages around.</p>
</div>
<div id="S3.p12" class="ltx_para">
<p class="ltx_p">Can you compile this application and run it? Don&rsquo;t get nervous, the simulation
can take a couple of minutes to finish. Have a look at the source code and try
to understand what&rsquo;s going on. Also have a look at the <code class="ltx_verbatim ltx_font_typewriter">stdout</code> log files.
Core 0 will also print the complete heat distribution at the end.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3.4 </span>The Look Inside: Introducing the Debug System</h2>

<div id="S4.p1" class="ltx_para ltx_docnote">
<p class="ltx_p ltx_docnote_title">Note</p>
<p class="ltx_p">This and the following sections have not been tested for this release,
and may most probably not run as described. But as a reference, they
can serve you to better understand OpTiMSoC. They will be rewritten
for the upcoming release. Thanks for your understanding!</p>
</div>
<div id="S4.p2" class="ltx_para">
<p class="ltx_p">In the previous tutorials you have seen some software running on a simple
OpTiMSoC system. Until now, you have only seen the output of the applications,
not how it works on the inside.
</p>
</div>
<div id="S4.p3" class="ltx_para">
<p class="ltx_p">This problem is one of the major problems in embedded systems: you cannot
easily look inside (especially as soon as you run on real hardware as opposed
to simulation). In more technical terms, the system&rsquo;s observability is
limited. A common way to overcome this is to add a debug and diagnosis
infrastructure to the SoC which transfers data from the system to the outside
world, usually to a PC of a developer.</p>
</div>
<div id="S4.p4" class="ltx_para">
<p class="ltx_p">OpTiMSoC also comes with an extensive debug system. In this section, we&rsquo;ll have
a look at this system, how it works and how you can use it to debug your
applications. But before diving into the details, we&rsquo;ll have a short discussion
of the basics which are necesssary to understand the system.</p>
</div>
<div id="S4.p5" class="ltx_para">
<p class="ltx_p">Many developers know debugging from their daily work. Most of the time it
involves running a program inside a debugger like GDB or Microsoft Visual
Studio, setting a breakpoint at the right line of code, and stepping through the
program from there on, running one instruction (or one line of code) at a time.</p>
</div>
<div id="S4.p6" class="ltx_para">
<p class="ltx_p">This technique is what we call run-control debugging. While it works great for
single-threaded programs, it cannot easily be applied to debugging parallel
software running on possibly heterogenous many-core SoC. Instead, our solution
is solely based on tracing, i.e. collecting information from the system while
it is running and then being able to look at this data later to figure out the
root cause of a problem.</p>
</div>
<div id="S4.p7" class="ltx_para">
<p class="ltx_p">The debug system consists of two main parts: the hardware part runs on the
OpTiMSoC system itself and collects all data. The other part runs on a
developer&rsquo;s PC (often also called host PC) and controls the debugging process
and displays the collected data. Both parts are connected using either a USB
connection (e.g. when running on the ZTEX boards), or a TCP connection (when
running OpTiMSoC in simulations).</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3.5 </span>Verilator: Compiled Verilog simulation</h2>

<div id="S5.p1" class="ltx_para">
<p class="ltx_p">At the moment running &ldquo;verilated&rdquo; simulations is the best supported
way of observing the system traces. We will therefore run the examples
from before using a verilated simulation and observing the system in
the graphical user interface.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p class="ltx_p">In the following we will have a look at building such a system and how
to observe it with the GUI. In <span class="ltx_ref ltx_path ltx_ref_self"><span class="ltx_text ltx_font_typewriter">tbench/verilator/dm</span></span> you find
systems identical to the RTL simulation. We will directly start with
the <code class="ltx_verbatim ltx_font_typewriter">system_2x2_cccc</code>. In the base folder you should simply make
it:</p>
</div>
<div id="S5.p3" class="ltx_para">
<div id="LSTx22" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,%24&gt;%20make">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">$&gt;<span class="ltx_text ltx_lst_space">&nbsp;</span>make</span>
              </td>
</tr>
</table>
</div>
</div>
<div id="S5.p4" class="ltx_para">
<p class="ltx_p">The command will first generate the verilated version of the 2x2
system. Finally it builds the toplevel files and links to
<code class="ltx_verbatim ltx_font_typewriter">tb_system_2x2_cccc</code> and <code class="ltx_verbatim ltx_font_typewriter">tb_system_2x2_cccc-vcd</code>. The
latter generates a full VCD trace file of the hardware, which is
much slower and also easily takes up tens of GB.</p>
</div>
<div id="S5.p5" class="ltx_para">
<p class="ltx_p">Similar to the steps described above you will need to build the
software, e.g., the heat example. Again you need to link the
<code class="ltx_verbatim ltx_font_typewriter">vmem</code> file. Now start the simulation:</p>
</div>
<div id="S5.p6" class="ltx_para">
<div id="LSTx23" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,%24&gt;%20./tb_system_2x2_cccc">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">$&gt;<span class="ltx_text ltx_lst_space">&nbsp;</span>./tb_system_2x2_cccc</span>
              </td>
</tr>
</table>
</div>
</div>
<div id="S5.p7" class="ltx_para">
<p class="ltx_p">It will start a debug server and wait for connections:</p>
</div>
<div id="S5.p8" class="ltx_para">
<div id="LSTx24" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,%0A%20%20%20%20%20%20%20%20%20%20%20%20%20SystemC%202.3.0-ASI%20---%20Feb%2011%202013%2012:54:17%0A%20%20%20%20%20%20%20%20Copyright%20(c)%201996-2012%20by%20all%20Contributors,%0A%20%20%20%20%20%20%20%20ALL%20RIGHTS%20RESERVED%0A%0AListening%20on%20port%2022000">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line"></span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter"><span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>SystemC<span class="ltx_text ltx_lst_space">&nbsp;</span>2.3.0-ASI<span class="ltx_text ltx_lst_space">&nbsp;</span>---<span class="ltx_text ltx_lst_space">&nbsp;</span>Feb<span class="ltx_text ltx_lst_space">&nbsp;</span>11<span class="ltx_text ltx_lst_space">&nbsp;</span>2013<span class="ltx_text ltx_lst_space">&nbsp;</span>12:54:17</span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter"><span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Copyright<span class="ltx_text ltx_lst_space">&nbsp;</span>(c)<span class="ltx_text ltx_lst_space">&nbsp;</span>1996-2012<span class="ltx_text ltx_lst_space">&nbsp;</span>by<span class="ltx_text ltx_lst_space">&nbsp;</span>all<span class="ltx_text ltx_lst_space">&nbsp;</span>Contributors,</span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter"><span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>ALL<span class="ltx_text ltx_lst_space">&nbsp;</span>RIGHTS<span class="ltx_text ltx_lst_space">&nbsp;</span>RESERVED</span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line"></span>
              </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">Listening<span class="ltx_text ltx_lst_space">&nbsp;</span>on<span class="ltx_text ltx_lst_space">&nbsp;</span>port<span class="ltx_text ltx_lst_space">&nbsp;</span>2200</span>
              </td>
</tr>
</table>
</div>
</div>
<div id="S5.p9" class="ltx_para">
<p class="ltx_p">In another console now start the OpTiMSoC GUI:
</p>
</div>
<div id="S5.p10" class="ltx_para">
<div id="LSTx25" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,%24&gt;%20optimsocgui">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                <span class="ltx_text ltx_lst_line ltx_font_typewriter">$&gt;<span class="ltx_text ltx_lst_space">&nbsp;</span>optimsocgui</span>
              </td>
</tr>
</table>
</div>
</div>
<div id="S5.p11" class="ltx_para">
<p class="ltx_p">In the first dialog window you need to set the debug backend to
<em class="ltx_emph">Simulation TCP Interface</em> and proceed then. After the GUI
started you need to connect using <em class="ltx_emph">Target
System</em><math id="S5.p11.m1" class="ltx_Math" alttext="\rightarrow" display="inline"><mo>&rarr;</mo></math><em class="ltx_emph">Connect</em>. The system view should change to
a 2x2 system.</p>
</div>
<div id="S5.p12" class="ltx_para">
<p class="ltx_p">The last step is to run the system by <em class="ltx_emph">Target
System</em><math id="S5.p12.m1" class="ltx_Math" alttext="\rightarrow" display="inline"><mo>&rarr;</mo></math><em class="ltx_emph">Start CPUs</em>. The execution trace on the
bottom of the window will start showing execution sections and events.
By moving the mouse over the section you will find the description of
the section. Similarly for the events you find a short description of
the event.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3.6 </span>Going to the FPGA: ZTEX Boards</h2>

<div id="S6.p1" class="ltx_para">
<p class="ltx_p">The recommended platform for software development or any other system
which needs no I/O is the ZTEX boards<a href="#optimsoc-doc-footnote-2"><sup>2</sup></a>. Various variants exist, the supported boards
are the 1.15 series version b and d, where the latter is twice as
large as the former and can therefore contain more processor cores.
The 2x2 example works with both boards.</p>
</div>
<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.6.1 </span>Prepare: Simulate the Complete System</h3>

<div id="S6.SS1.p1" class="ltx_para">
<p class="ltx_p">Before we go to the actual board we want to simulate the entire system
on the FPGA to see if the debug system works correctly and the
clocks works correct.</p>
</div>
<div id="S6.SS1.p2" class="ltx_para">
<p class="ltx_p">The distribution therefore contains a SystemC module that functionally
behaves like the USB chip on the ZTEX boards. The host tools can
connect to the debug system via this module using a TCP socket.</p>
</div>
<div id="S6.SS1.p3" class="ltx_para">
<p class="ltx_p">The system can be found at <span class="ltx_ref ltx_path ltx_ref_self"><span class="ltx_text ltx_font_typewriter">tbench/rtl/dm/system_2x2_cccc_ztex</span></span>.
Build the system running <code class="ltx_verbatim ltx_font_typewriter">make</code>. Before you simulate the system
you will now need to provide a <code class="ltx_verbatim ltx_font_typewriter">modelsim.ini</code> either globally or
in the system&rsquo;s folder that contains the Xilinx libraries. Once you
have it, you can start the system using</p>
</div>
<div id="S6.SS1.p4" class="ltx_para">
<div id="LSTx26" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,%24&gt;%20make%20sim-noninteractive">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">$&gt;<span class="ltx_text ltx_lst_space">&nbsp;</span>make<span class="ltx_text ltx_lst_space">&nbsp;</span>sim-noninteractive</span>
                </td>
</tr>
</table>
</div>
</div>
<div id="S6.SS1.p5" class="ltx_para">
<p class="ltx_p">The simulation will start and you can now connect
to the system in a different shell by using the command line
interface:</p>
</div>
<div id="S6.SS1.p6" class="ltx_para">
<div id="LSTx27" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,%24&gt;%20optimsoc_cli%20-bdbgnoc%20-oconn=tcp,host=localhost,port=23000">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">$&gt;<span class="ltx_text ltx_lst_space">&nbsp;</span>optimsoc_cli<span class="ltx_text ltx_lst_space">&nbsp;</span>-bdbgnoc<span class="ltx_text ltx_lst_space">&nbsp;</span>-oconn=tcp,host=localhost,port=2300</span>
                </td>
</tr>
</table>
</div>
</div>
<div id="S6.SS1.p7" class="ltx_para">
<p class="ltx_p">The command line interface will connect to the system and enumerate
all debug modules:</p>
</div>
<div id="S6.SS1.p8" class="ltx_para">
<div id="LSTx28" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,Connected%20to%20system.%0ASystem%20ID:%200x0000ce75%0AModule%20summary:%0Aaddr.%09type%09version%09name%0A0x02%090x02%090x00%09ITM%0A0x03%090x02%090x00%09ITM%0A0x04%090x02%090x00%09ITM%0A0x05%090x02%090x00%09ITM%0A0x06%090x05%090x00%09STM%0A0x07%090x05%090x00%09STM%0A0x08%090x05%090x00%09STM%0A0x09%090x05%090x00%09STM%0A0x0a%090x07%090x00%09MAM%0A0x0b%090x07%090x00%09MAM%0A0x0c%090x07%090x00%09MAM%0A0x0d%090x07%090x00%09MAM">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">Connected<span class="ltx_text ltx_lst_space">&nbsp;</span>to<span class="ltx_text ltx_lst_space">&nbsp;</span>system.</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">System<span class="ltx_text ltx_lst_space">&nbsp;</span>ID:<span class="ltx_text ltx_lst_space">&nbsp;</span>0x0000ce75</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">Module<span class="ltx_text ltx_lst_space">&nbsp;</span>summary:</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">addr.<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;</span>type<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>version<span class="ltx_text ltx_lst_space">&nbsp;</span>name</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">0x02<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x02<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x00<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>ITM</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">0x03<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x02<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x00<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>ITM</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">0x04<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x02<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x00<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>ITM</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">0x05<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x02<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x00<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>ITM</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">0x06<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x05<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x00<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>STM</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">0x07<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x05<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x00<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>STM</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">0x08<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x05<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x00<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>STM</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">0x09<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x05<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x00<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>STM</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">0x0a<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x07<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x00<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>MAM</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">0x0b<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x07<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x00<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>MAM</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">0x0c<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x07<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x00<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>MAM</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">0x0d<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x07<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>0x00<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>MAM</span>
                </td>
</tr>
</table>
</div>
</div>
<div id="S6.SS1.p9" class="ltx_para">
<p class="ltx_p">The modules are the <em class="ltx_emph">Instruction Trace Module (ITM)</em>,
<em class="ltx_emph">Software Trace Module (STM)</em> and <em class="ltx_emph">Memory Access Module
(MAM)</em> for each of the four cores.</p>
</div>
<div id="S6.SS1.p10" class="ltx_para">
<p class="ltx_p">Before debugging now, you will need to build the software as described
before in the <code class="ltx_verbatim ltx_font_typewriter">sw</code> subfolder. Once you have build
<code class="ltx_verbatim ltx_font_typewriter">hello_simplemp</code> you can execute it in the simulation.</p>
</div>
<div id="S6.SS1.p11" class="ltx_para">
<p class="ltx_p">First you enter interactive mode:</p>
</div>
<div id="S6.SS1.p12" class="ltx_para">
<div id="LSTx29" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,%24&gt;%20optimsoc_cli%20-bdbgnoc%20-oconn=tcp,host=localhost,port=23000">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">$&gt;<span class="ltx_text ltx_lst_space">&nbsp;</span>optimsoc_cli<span class="ltx_text ltx_lst_space">&nbsp;</span>-bdbgnoc<span class="ltx_text ltx_lst_space">&nbsp;</span>-oconn=tcp,host=localhost,port=2300</span>
                </td>
</tr>
</table>
</div>
</div>
<div id="S6.SS1.p13" class="ltx_para">
<p class="ltx_p">After enumeration you will get an <code class="ltx_verbatim ltx_font_typewriter">OpTiMSoC&gt;</code> shell. First you
can initialize the memories:</p>
</div>
<div id="S6.SS1.p14" class="ltx_para">
<div id="LSTx30" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,OpTiMSoC&gt;%20mem_init%20hello_simplemp.bin%200-3">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">OpTiMSoC&gt;<span class="ltx_text ltx_lst_space">&nbsp;</span>mem_init<span class="ltx_text ltx_lst_space">&nbsp;</span>hello_simplemp.bin<span class="ltx_text ltx_lst_space">&nbsp;</span>0-3</span>
                </td>
</tr>
</table>
</div>
</div>
<div id="S6.SS1.p15" class="ltx_para">
<p class="ltx_p">Next you need to enable logging of the software trace events to a
file:</p>
</div>
<div id="S6.SS1.p16" class="ltx_para">
<div id="LSTx31" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,OpTiMSoC&gt;%20log_stm_trace%20strace">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">OpTiMSoC&gt;<span class="ltx_text ltx_lst_space">&nbsp;</span>log_stm_trace<span class="ltx_text ltx_lst_space">&nbsp;</span>strace</span>
                </td>
</tr>
</table>
</div>
</div>
<div id="S6.SS1.p17" class="ltx_para">
<p class="ltx_p">Then start the system:</p>
<div id="LSTx32" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,OpTiMSoC&gt;%20start">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">OpTiMSoC&gt;<span class="ltx_text ltx_lst_space">&nbsp;</span>start</span>
                </td>
</tr>
</table>
</div>
</div>
<div id="S6.SS1.p18" class="ltx_para">
<p class="ltx_p">Let it run for a while (1 minute) and then leave the command line
interface:</p>
<div id="LSTx33" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,OpTiMSoC&gt;%20quit">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">OpTiMSoC&gt;<span class="ltx_text ltx_lst_space">&nbsp;</span>quit</span>
                </td>
</tr>
</table>
</div>
</div>
<div id="S6.SS1.p19" class="ltx_para">
<p class="ltx_p">After that you will find the expected output of the trace events in
<code class="ltx_verbatim ltx_font_typewriter">strace</code>.</p>
</div>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.6.2 </span>Synthesis</h3>

<div id="S6.SS2.p1" class="ltx_para">
<p class="ltx_p">Once you have checked the correct functionality of the system (or
alter your extensions) you can go over to system synthesis for the
FPGA. At the moment we support the Synopsys FPGA flow (Synplify).
</p>
</div>
<div id="S6.SS2.p2" class="ltx_para">
<p class="ltx_p">You can find the system synthesis in the folder
<span class="ltx_ref ltx_path ltx_ref_self"><span class="ltx_text ltx_font_typewriter">syn/dm/system_2x2_cccc_ztex</span></span>. A Makefile is used to build the
systems.</p>
</div>
<div id="S6.SS2.p3" class="ltx_para">
<p class="ltx_p">To generate the system first create the project file:</p>
</div>
<div id="S6.SS2.p4" class="ltx_para">
<div id="LSTx34" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,%24&gt;%20make%20synplify.prj">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">$&gt;<span class="ltx_text ltx_lst_space">&nbsp;</span>make<span class="ltx_text ltx_lst_space">&nbsp;</span>synplify.prj</span>
                </td>
</tr>
</table>
</div>
</div>
<div id="S6.SS2.p5" class="ltx_para">
<p class="ltx_p">Now the Synplify project file has been generated and you&rsquo;re ready to start the
synthesis.</p>
</div>
<div id="S6.SS2.p6" class="ltx_para">
<p class="ltx_p">If you want to have the output of the synthesis in a folder different from your
source folder (the one where you just ran <code class="ltx_verbatim ltx_font_typewriter">make</code> in), you can set the
environment variable <code class="ltx_verbatim ltx_font_typewriter">OPTIMSOC_SYN_OUTDIR</code> to any path you like, e.g. put</p>
<div id="LSTx35" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,export%20OPTIMSOC_SYN_OUTDIR=%24HOME/syn">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">export<span class="ltx_text ltx_lst_space">&nbsp;</span>OPTIMSOC_SYN_OUTDIR=$HOME/syn</span>
                </td>
</tr>
</table>
</div>
<p class="ltx_p">in your profile script (e.g. your <span class="ltx_ref ltx_path ltx_ref_self"><span class="ltx_text ltx_font_typewriter">~/.bashrc</span></span> file) and reload it.</p>
</div>
<div id="S6.SS2.p7" class="ltx_para">
<p class="ltx_p">Run the synthesis afterwards (for the ZTEX 1.15b or d board):</p>
</div>
<div id="S6.SS2.p8" class="ltx_para">
<div id="LSTx36" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,%24&gt;%20make%20synplify_115b_ddr">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">$&gt;<span class="ltx_text ltx_lst_space">&nbsp;</span>make<span class="ltx_text ltx_lst_space">&nbsp;</span>synplify_115b_ddr</span>
                </td>
</tr>
</table>
</div>
</div>
<div id="S6.SS2.p9" class="ltx_para">
<p class="ltx_p">Once the synthesis is finished you can generate the bitstream:</p>
</div>
<div id="S6.SS2.p10" class="ltx_para">
<div id="LSTx37" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,%24&gt;%20make%20bitgen_115d_ddr">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">$&gt;<span class="ltx_text ltx_lst_space">&nbsp;</span>make<span class="ltx_text ltx_lst_space">&nbsp;</span>bitgen_115d_ddr</span>
                </td>
</tr>
</table>
</div>
</div>
</section>
<section id="S6.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.6.3 </span>Testing on the FPGA</h3>

<div id="S6.SS3.p1" class="ltx_para">
<p class="ltx_p">Now that you have generated a bitstream we&rsquo;re ready to upload it to the FPGA.
Connect the ZTEX 1.15 board to your PC via USB.</p>
</div>
<div id="S6.SS3.p2" class="ltx_para">
<p class="ltx_p">If you run <code class="ltx_verbatim ltx_font_typewriter">lsusb</code> the board identifies itself as:</p>
</div>
<div id="S6.SS3.p3" class="ltx_para">
<div id="LSTx38" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,Bus%20001%20Device%20004:%20ID%20221a:0100">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">Bus<span class="ltx_text ltx_lst_space">&nbsp;</span>001<span class="ltx_text ltx_lst_space">&nbsp;</span>Device<span class="ltx_text ltx_lst_space">&nbsp;</span>004:<span class="ltx_text ltx_lst_space">&nbsp;</span>ID<span class="ltx_text ltx_lst_space">&nbsp;</span>221a:010</span>
                </td>
</tr>
</table>
</div>
</div>
<div id="S6.SS3.p4" class="ltx_para">
<p class="ltx_p">There is no manufacturer or further information displayed. The reason
is, that OpTiMSoC otherwise may require to buy a set of USB
identifiers. Instead, all ZTEX boards share the same identifier and
the following command is used to find out details on the Firmware,
Board and Capabilities:</p>
</div>
<div id="S6.SS3.p5" class="ltx_para">
<div id="LSTx39" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,%24&gt;%20FWLoader%20-c%20-ii">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">$&gt;<span class="ltx_text ltx_lst_space">&nbsp;</span>FWLoader<span class="ltx_text ltx_lst_space">&nbsp;</span>-c<span class="ltx_text ltx_lst_space">&nbsp;</span>-ii</span>
                </td>
</tr>
</table>
</div>
</div>
<div id="S6.SS3.p6" class="ltx_para">
<p class="ltx_p">To use the ZTEX boards as a user, it is recommended to add the following
udev rule</p>
</div>
<div id="S6.SS3.p7" class="ltx_para">
<div id="LSTx40" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,SUBSYSTEM==%22usb%22,%20ATTR%7BidVendor%7D==%22221a%22,%20ATTR%7BidProduct%7D==%220100%22,%20MODE=%220666%22">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">SUBSYSTEM=="usb",<span class="ltx_text ltx_lst_space">&nbsp;</span>ATTRidVendor}=="221a",<span class="ltx_text ltx_lst_space">&nbsp;</span>ATTRidProduct}=="0100",<span class="ltx_text ltx_lst_space">&nbsp;</span>MODE="0666"</span>
                </td>
</tr>
</table>
</div>
</div>
<div id="S6.SS3.p8" class="ltx_para">
<p class="ltx_p">for example in <code class="ltx_verbatim ltx_font_typewriter">/etc/udev/rules.d/60-usb.rules</code>.</p>
</div>
<div id="S6.SS3.p9" class="ltx_para">
<p class="ltx_p">If you are running OpTiMSoC on the board for the first time you need to update
the firmware on the board. To do that, switch to the folder
<span class="ltx_ref ltx_path ltx_ref_self"><span class="ltx_text ltx_font_typewriter">src/sw/firmware/ztex_usbfpga_1_15_fx2_fw</span></span> in your OpTiMSoC source tree.
Follow the instructions inside the provided <code class="ltx_verbatim ltx_font_typewriter">README</code> file to build and
flash the board with the required firmware. All of this only needs to be done
once for each board (until the firmware changes).</p>
</div>
<div id="S6.SS3.p10" class="ltx_para">
<p class="ltx_p">Now the board will identify itself using <code class="ltx_verbatim ltx_font_typewriter">FWLoader -c -ii</code>:</p>
</div>
<div id="S6.SS3.p11" class="ltx_para">
<div id="LSTx41" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,bus=001%20%20device=4%20(%60004')%20%20ID=221a:100%0A%20%20%20Manufacturer=%22TUM%20LIS%22%20%20Product=%22OpTiMSoC%20-%20ZTEX%20USB%201.15%22%20%20%20%20SerialNumber=%2204A32DBCFA%22%0A%20%20%20productID=10.13.0.0%20%20fwVer=0%20%20ifVer=1%0A%20%20%20FPGA%20configured%0A%20%20%20Capabilities:%0A%20%20%20%20%20%20EEPROM%20read/write%0A%20%20%20%20%20%20FPGA%20configuration%0A%20%20%20%20%20%20Flash%20memory%20support%0A%20%20%20%20%20%20High%20speed%20FPGA%20configuration%0A%20%20%20%20%20%20MAC%20EEPROM%20read/write">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">bus=001<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;</span>device=4<span class="ltx_text ltx_lst_space">&nbsp;</span>(`004')<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;</span>ID=221a:100</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter"><span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;</span>Manufacturer="TUM<span class="ltx_text ltx_lst_space">&nbsp;</span>LIS"<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;</span>Product="OpTiMSoC<span class="ltx_text ltx_lst_space">&nbsp;</span>-<span class="ltx_text ltx_lst_space">&nbsp;</span>ZTEX<span class="ltx_text ltx_lst_space">&nbsp;</span>USB<span class="ltx_text ltx_lst_space">&nbsp;</span>1.15"<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;</span>SerialNumber="04A32DBCFA"</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter"><span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;</span>productID=10.13.0.0<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;</span>fwVer=0<span class="ltx_text ltx_lst_space">&nbsp;&nbsp;</span>ifVer=1</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter"><span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;</span>FPGA<span class="ltx_text ltx_lst_space">&nbsp;</span>configured</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter"><span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;</span>Capabilities:</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter"><span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>EEPROM<span class="ltx_text ltx_lst_space">&nbsp;</span>read/write</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter"><span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>FPGA<span class="ltx_text ltx_lst_space">&nbsp;</span>configuration</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter"><span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Flash<span class="ltx_text ltx_lst_space">&nbsp;</span>memory<span class="ltx_text ltx_lst_space">&nbsp;</span>support</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter"><span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>High<span class="ltx_text ltx_lst_space">&nbsp;</span>speed<span class="ltx_text ltx_lst_space">&nbsp;</span>FPGA<span class="ltx_text ltx_lst_space">&nbsp;</span>configuration</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter"><span class="ltx_text ltx_lst_space">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>MAC<span class="ltx_text ltx_lst_space">&nbsp;</span>EEPROM<span class="ltx_text ltx_lst_space">&nbsp;</span>read/write</span>
                </td>
</tr>
</table>
</div>
</div>
<div id="S6.SS3.p12" class="ltx_para">
<p class="ltx_p">Everything ready to go? Then upload the bitstream to the FPGA by running</p>
</div>
<div id="S6.SS3.p13" class="ltx_para">
<div id="LSTx42" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,%24&gt;%20make%20flash_115d_ddr">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">$&gt;<span class="ltx_text ltx_lst_space">&nbsp;</span>make<span class="ltx_text ltx_lst_space">&nbsp;</span>flash_115d_ddr</span>
                </td>
</tr>
</table>
</div>
</div>
<div id="S6.SS3.p14" class="ltx_para">
<p class="ltx_p">in the same folder where you have been running <code class="ltx_verbatim ltx_font_typewriter">make bitstream_...</code> etc.
in the previous section. The output should be something like</p>
</div>
<div id="S6.SS3.p15" class="ltx_para">
<div id="LSTx43" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,FWLoader%20-v%200x221a%200x100%20-f%20-uf%20/%5Bsomepath%5D/system_2x2_cccc_ztex.bit%0AFPGA%20configuration%20time:%20194%20ms">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">FWLoader<span class="ltx_text ltx_lst_space">&nbsp;</span>-v<span class="ltx_text ltx_lst_space">&nbsp;</span>0x221a<span class="ltx_text ltx_lst_space">&nbsp;</span>0x100<span class="ltx_text ltx_lst_space">&nbsp;</span>-f<span class="ltx_text ltx_lst_space">&nbsp;</span>-uf<span class="ltx_text ltx_lst_space">&nbsp;</span>/[somepath]/system_2x2_cccc_ztex.bit</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">FPGA<span class="ltx_text ltx_lst_space">&nbsp;</span>configuration<span class="ltx_text ltx_lst_space">&nbsp;</span>time:<span class="ltx_text ltx_lst_space">&nbsp;</span>194<span class="ltx_text ltx_lst_space">&nbsp;</span>ms</span>
                </td>
</tr>
</table>
</div>
</div>
<div id="S6.SS3.p16" class="ltx_para">
<p class="ltx_p">As the FPGA is now ready you can use the same method to connect to the
FPGA and load software on it as you&rsquo;ve done in the Section
<a href="#S6.SS1" title="3.6.1 Prepare: Simulate the Complete System &#8227; 3.6 Going to the FPGA: ZTEX Boards &#8227; Chapter&nbsp;3 Tutorials &#8227; OpTiMSoC User Guide" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.6.1</span></a>, just this time the
connection paramters used in <code class="ltx_verbatim ltx_font_typewriter">optimsoc_cli</code> are a bit different.</p>
</div>
<div id="S6.SS3.p17" class="ltx_para">
<p class="ltx_p">Run</p>
<div id="LSTx44" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,%24&gt;%20optimsoc_cli%20-i%20-bdbgnoc%20-oconn=usb">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">$&gt;<span class="ltx_text ltx_lst_space">&nbsp;</span>optimsoc_cli<span class="ltx_text ltx_lst_space">&nbsp;</span>-i<span class="ltx_text ltx_lst_space">&nbsp;</span>-bdbgnoc<span class="ltx_text ltx_lst_space">&nbsp;</span>-oconn=usb</span>
                </td>
</tr>
</table>
</div>
</div>
<div id="S6.SS3.p18" class="ltx_para">
<p class="ltx_p">to connect to the FPGA board over USB. You should again be presented with a
listing of all available debug modules. Now you can continue just as you did
before by calling <code class="ltx_verbatim ltx_font_typewriter">mem_init</code> to load some software onto the FPGA, etc.</p>
</div>
<div id="S6.SS3.p19" class="ltx_para">
<p class="ltx_p">Congratulations, you&rsquo;ve run OpTiMSoC on real hardware for the first
time! You can now develop software and explore OpTiMSoC. A handy
utility is the python interface to the command line interface. Instead
of running the interactive mode you can run the script interface like:</p>
</div>
<div id="S6.SS3.p20" class="ltx_para">
<div id="LSTx45" class="ltx_listingblock ltx_lstlisting ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,%24&gt;%20optimsoc_cli%20-s%20&lt;script.py&gt;%20-bdbgnoc%20-oconn=usb">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">$&gt;<span class="ltx_text ltx_lst_space">&nbsp;</span>optimsoc_cli<span class="ltx_text ltx_lst_space">&nbsp;</span>-s<span class="ltx_text ltx_lst_space">&nbsp;</span>&lt;script.py&gt;<span class="ltx_text ltx_lst_space">&nbsp;</span>-bdbgnoc<span class="ltx_text ltx_lst_space">&nbsp;</span>-oconn=usb</span>
                </td>
</tr>
</table>
</div>
</div>
<div id="S6.SS3.p21" class="ltx_para">
<p class="ltx_p">An example python script:</p>
</div>
<div id="S6.SS3.p22" class="ltx_para">
<div id="LSTx46" class="ltx_listingblock ltx_lstlisting ltx_lst_language_python ltx_listing">
<div class="ltx_listing_data"><a href="data:text/plain,mem_init(2,%22hello_simple.bin%22)%0Alog_stm_trace(%22strace%22)%0Astart()">&#11015;</a></div>
<table class="ltx_tabular">
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">mem_init(2,"hello_simple.bin")</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">log_stm_trace("strace")</span>
                </td>
</tr>
<tr class="ltx_tr">
<td class="ltx_td">
                  <span class="ltx_text ltx_lst_line ltx_font_typewriter">start()</span>
                </td>
</tr>
</table>
</div>
</div>
<div id="S6.SS3.p23" class="ltx_para">
<p class="ltx_p">You can also connect to the USB now using the GUI. Now you&rsquo;re ready to
explore and customize OpTiMSoC for yourself. Have fun!</p>
</div>
</section>
</section>
</section>
</div>
</div>
<hr class="optimsoc-doc-sep-footnotes">
<div class="optimsoc-doc-footnote-full" id="optimsoc-doc-footnote-2">
<sup>2</sup>See
<a href="http://www.ztex.de" title="" class="ltx_ref ltx_url"><span class="ltx_text ltx_font_typewriter">http://www.ztex.de</span></a>
</div>
</div>

</div>


  <!-- footer -->
  <hr>
  <footer class="optimsoc-footer">
    <p>OpTiMSoC &copy; 2012-2020 OpTiMSoC Maintainers &middot; Imprint</p>
  </footer>

  <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
  <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
</body>
</html>
