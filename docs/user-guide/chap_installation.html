---
layout: default
title: OpTiMSoC User Guide
sectiontitle: User Guide
---
    <div class="col-md-3">
<div class="optimsoc-doc-mainnav"><ul class="nav">
<li><a href="chap_introduction.html" title="Chapter&nbsp;1 Introduction &#8227; OpTiMSoC User Guide">Introduction</a></li>
<li><a href="" title="Chapter&nbsp;2 Installation &amp; Configuration &#8227; OpTiMSoC User Guide">Installation &amp; Configuration</a></li>
<li><a href="chap_tutorials.html" title="Chapter&nbsp;3 Tutorials &#8227; OpTiMSoC User Guide">Tutorials</a></li>
<li><a href="Ch4.html" title="Chapter&nbsp;4 Develop OpTiMSoC &#8227; OpTiMSoC User Guide">Develop OpTiMSoC</a></li>
</ul></div>
<div id="optimsoc-doc-subnav-nav" class="optimsoc-doc-subnav hidden-print" data-spy="affix" data-offset-top="200" role="complementary"><ul class="nav">
<li class=""><a href="#S1" title="2.1 Prerequisites &#8227; Chapter&nbsp;2 Installation &amp; Configuration &#8227; OpTiMSoC User Guide">Prerequisites</a></li>
<li class=""><a href="#S2" title="2.2 Get OpTiMSoC &#8227; Chapter&nbsp;2 Installation &amp; Configuration &#8227; OpTiMSoC User Guide">Get OpTiMSoC</a></li>
<li class=""><a href="#S3" title="2.3 OpTiMSoC Installation Path &#8227; Chapter&nbsp;2 Installation &amp; Configuration &#8227; OpTiMSoC User Guide">OpTiMSoC Installation Path</a></li>
<li class=""><a href="#S4" title="2.4 OpTiMSoC Toolchain &#8227; Chapter&nbsp;2 Installation &amp; Configuration &#8227; OpTiMSoC User Guide">OpTiMSoC Toolchain</a></li>
<li class=""><a href="#S5" title="2.5 Host Software &#8227; Chapter&nbsp;2 Installation &amp; Configuration &#8227; OpTiMSoC User Guide">Host Software</a></li>
<li class=""><a href="#S6" title="2.6 ZTEX Tools &#8227; Chapter&nbsp;2 Installation &amp; Configuration &#8227; OpTiMSoC User Guide">ZTEX Tools</a></li>
<li class=""><a href="#S7" title="2.7 SystemC, Verilator and SystemC Libraries &#8227; Chapter&nbsp;2 Installation &amp; Configuration &#8227; OpTiMSoC User Guide">SystemC, Verilator and SystemC Libraries</a></li>
<li class=""><a href="#S8" title="2.8 Configuration Summary &#8227; Chapter&nbsp;2 Installation &amp; Configuration &#8227; OpTiMSoC User Guide">Configuration Summary</a></li>
<li class=""><a href="#S9" title="2.9 Upgrade from rel-20130620 &#8227; Chapter&nbsp;2 Installation &amp; Configuration &#8227; OpTiMSoC User Guide">Upgrade from rel-20130620</a></li>
</ul></div>
</div><div class="col-md-9 optimsoc-doc-body">
<div class="ltx_page_main">
<div class="ltx_page_content">
<div class="ltx_chapter">
<h1 class="ltx_title ltx_title_chapter">
<span class="ltx_tag ltx_tag_chapter">Chapter&nbsp;2 </span>Installation &amp; Configuration</h1>
<div class="ltx_date ltx_role_creation"></div>

<div id="p1" class="ltx_para">
<p class="ltx_p">Before you get started with OpTiMSoC you should notice that external
tools and libraries might be required that are in some cases
proprietary and cost some money. Although OpTiMSoC is developed at an
university with access to many EDA tools, we aim to always provide
tool flows and support for open and free tools, but especially when it
comes to synthesis such alternatives are even not available.</p>
</div>
<div id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2.1 </span>Prerequisites</h2>

<div id="S1.p1" class="ltx_para">
<p class="ltx_p">Throughout this document some packages are required in your Linux
distribution. OpTiMSoC should principally work on all common Linux
distributions. In case you encounter problems in your system we highly
encourage you to contact the OpTiMSoC maintainers to fix these
problems. Nevertheless, we recommend Ubuntu 12.04 or 14.04 LTS as
development system and can ensure OpTiMSoC will work on it as we also
work on it. In the following we will refer to Ubuntu/Debian commands
to install packages, that will run under Ubuntu 12.04 and 14.04 LTS.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p class="ltx_p">Independent of the components you plan to use, you will need some
packages to be installed:</p>
</div>
<div id="S1.p3" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
$&gt; sudo apt-get -y install git g++ python libtool automake autoconf \   libusb-1.0-0-dev libreadline6-dev cmake sdcc
</pre>
</div>
</div>
<div id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2.2 </span>Get OpTiMSoC</h2>

<div id="S2.p1" class="ltx_para">
<p class="ltx_p">OpTiMSoC does not come as an installation package, but is distributed
as a git<a href="#optimsoc-doc-footnote-2"><sup>2</sup></a> repository. The repository
is needed for two purposes. First, it is the installation source for
tools and libraries. Second, the hardware sources, applications
etc. are contained there to create your OpTiMSoC systems.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p class="ltx_p">It is generally a good idea to understand git, especially when you
plan to contribute to OpTiMSoC. Nevertheless, we will give a more
detailed explanation of how to get your personal copies of OpTiMSoC
and (potentially) update them.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p class="ltx_p">Before you get started, you should clone the LISNoC and OpTiMSoC
repository:</p>
</div>
<div id="S2.p4" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
$&gt; git clone https://github.com/TUM-LIS/lisnoc.git
$&gt; git clone https://github.com/TUM-LIS/optimsoc.git
</pre>
</div>
<div id="S2.p5" class="ltx_para">
<p class="ltx_p">After cloning you will have the main branch at its latest state. This
should in general work then, but to ensure you are on a certain
release you can set the state of the repository accordingly.</p>
</div>
<div id="S2.p6" class="ltx_para">
<p class="ltx_p">You can list all releases:</p>
</div>
<div id="S2.p7" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
$&gt; git tag
</pre>
</div>
<div id="S2.p8" class="ltx_para">
<p class="ltx_p">The release tags have the form <span class="ltx_text ltx_font_typewriter">rel<em class="ltx_emph">yyyymmdd</em></span> where
<em class="ltx_emph ltx_font_typewriter">yyyy</em> is the year, <em class="ltx_emph ltx_font_typewriter">mm</em> is the month and
<em class="ltx_emph ltx_font_typewriter">dd</em> is the day of the release.</p>
</div>
<div id="S2.p9" class="ltx_para">
<p class="ltx_p">You can set each of the repositories to a certain release, e.g.,</p>
</div>
<div id="S2.p10" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
$&gt; git checkout rel<em class="ltx_emph">yyyymmdd</em>
</pre>
</div>
<div id="S2.p11" class="ltx_para">
<p class="ltx_p">As a starter, it is recommended that you set your repositories to the
latest release, which is always available as <span class="ltx_text ltx_font_typewriter">rel-current</span>:</p>
</div>
<div id="S2.p12" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">$&gt; git checkout rel-current
</pre>
</div>
<div id="S2.p13" class="ltx_para">
<p class="ltx_p">For all work with OpTiMSoC you will need to have both repositories
available.</p>
</div>
<div id="S2.p14" class="ltx_para">
<p class="ltx_p">In the future it is necessary for some scripts to know where to find
everything. Therefore you need to set the following environment
variables (e.g., in your <code class="ltx_verbatim ltx_font_typewriter">.bashrc</code>):</p>
</div>
<div id="S2.p15" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
export LISNOC=<em class="ltx_emph">/path/to/lisnoc/clone</em>
export LISNOC_RTL=$<span class="ltx_text ltx_font_serif">{</span>LISNOC<span class="ltx_text ltx_font_serif">}</span>/rtl
export OPTIMSOC=<em class="ltx_emph">/path/to/optimsoc/clone</em>
export OPTIMSOC_RTL=$<span class="ltx_text ltx_font_serif">{</span>OPTIMSOC<span class="ltx_text ltx_font_serif">}</span>/src/rtl
export OPTIMSOC_SYSC=$<span class="ltx_text ltx_font_serif">{</span>OPTIMSOC<span class="ltx_text ltx_font_serif">}</span>/src/sysc
</pre>
</div>
<div id="S2.p16" class="ltx_para">
<p class="ltx_p">With the environment variables set, you can start using OpTiMSoC.</p>
</div>
</div>
<div id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2.3 </span>OpTiMSoC Installation Path</h2>

<div id="S3.p1" class="ltx_para">
<p class="ltx_p">As mentioned before, some parts of OpTiMSoC (libraries and tools) need
to be built and then also installed. Those are common for different
platforms you create.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p class="ltx_p">You can install the files whereever you want as some environment
variables (<code class="ltx_verbatim ltx_font_typewriter">PATH</code>, <code class="ltx_verbatim ltx_font_typewriter">PKG_CONFIG_PATH</code>, etc.) help finding
them. Throughout this document we use the environment variable
<code class="ltx_verbatim ltx_font_typewriter">OPTIMSOC_INSTALLATION</code>, which we recommend to be set to</p>
</div>
<div id="S3.p3" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
export OPTIMSOC_INSTALLATION=/opt/optimsoc
</pre>
</div>
<div id="S3.p4" class="ltx_para">
<p class="ltx_p">as installation path.</p>
</div>
</div>
<div id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2.4 </span>OpTiMSoC Toolchain</h2>

<div id="S4.p1" class="ltx_para">
<p class="ltx_p">The toolchain of OpTiMSoC currently consists of the standard OpenRISC
crosscompiler with multicore extensions plus a few small utility
programs and scripts.</p>
</div>
<div id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4.1 </span>Prerequisites</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p class="ltx_p">In Ubuntu 12.04 LTS (and of course anywhere else) you will need
libgmp, install</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
$&gt; sudo apt-get install libgmp3c2
</pre>
</div>
</div>
<div id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4.2 </span>Compiler and C Library</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p class="ltx_p">In most cases you will not need to build the entire toolchain from
scratch, but download the pre-compiled toolchain.</p>
</div>
<div id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Option 1: Download the entire toolchain</h4>

<div id="S4.SS2.SSS1.p1" class="ltx_para">
<p class="ltx_p">You can download pre-built packages with the crosscompiler toolchain
from <a href="http://lis.ei.tum.de/pub-download/optimsoc/toolchain" title="" class="ltx_ref ltx_url"><span class="ltx_text ltx_font_typewriter">http://lis.ei.tum.de/pub-download/optimsoc/toolchain</span></a>. The
standard installation directory is <code class="ltx_verbatim ltx_font_typewriter">/opt/optimsoc/toolchain</code> to
where you need to unzip the latest toolchain. To change the
installation path you can either build it manually as described in the
reference manual, or you can relocate the installation that contains
static references (untested).</p>
</div>
<div id="S4.SS2.SSS1.p2" class="ltx_para">
<p class="ltx_p">Follow these steps:</p>
</div>
<div id="S4.SS2.SSS1.p3" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
$&gt; cd /opt/optimsoc
$&gt; mkdir toolchain
$&gt; cd toolchain
$&gt; wget http://lis.ei.tum.de/pub-download/optimsoc/toolchain/optimsoc-toolchain-current.tgz
$&gt; tar -xjf optimsoc-toolchain-current.tgz
</pre>
</div>
<div id="S4.SS2.SSS1.p4" class="ltx_para">
<p class="ltx_p">Set your environment (e.g., in <code class="ltx_verbatim ltx_font_typewriter">~/.bashrc</code>):</p>
</div>
<div id="S4.SS2.SSS1.p5" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
export PATH=$OPTIMSOC_INSTALLATION/toolchain/bin:$<span class="ltx_text ltx_font_serif">{</span>PATH<span class="ltx_text ltx_font_serif">}</span>
</pre>
</div>
</div>
<div id="S4.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Option 2: Build the whole toolchain</h4>

<div id="S4.SS2.SSS2.p1" class="ltx_para">
<p class="ltx_p">Please consider the Reference Guide for information how to build the
toolchain manually.</p>
</div>
</div>
</div>
<div id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4.3 </span>TCL Environment &amp; Additional Scripts</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p class="ltx_p">In the EDA field TCL is still the scripting language of choice.
Fortunately, all of the EDA tools have a TCL scripting interface. To
allow for easier creation of projects and compile RTL sources we added
some TCL scripts for all modules and targets. Beside the TCL scripts
some Python scripts and utility programs are required by the OpTiMSoC
platforms.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p class="ltx_p">To install the tools simply run</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
$&gt; $OPTIMSOC/tools/install.sh $OPTIMSOC_INSTALLATION
</pre>
</div>
<div id="S4.SS3.p4" class="ltx_para">
<p class="ltx_p">or replace your installation path accordingly.</p>
</div>
<div id="S4.SS3.p5" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
OPTIMSOC_TCL=$OPTIMSOC_INSTALLATION/tools/tcl
PATH=$PATH:$OPTIMSOC_INSTALLATION/tools/utils
</pre>
</div>
</div>
<div id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4.4 </span>System Software</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p class="ltx_p">There are essential two different ways to develop software for
OpTiMSoC, either as baremetal software or using the compute node
operating system gzll. For both ways you need to compile a set of
libraries that help you developing software for OpTiMSoC.</p>
</div>
<div id="S4.SS4.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Baremetal System Software</h4>

<div id="S4.SS4.SSS1.p1" class="ltx_para">
<p class="ltx_p">There are a set of libraries you build in one run, most important the
baremetal drivers, some support for runtime systems (scheduler,
virtual memory) and message passing support. The installation consist
of the libraries themselves and build infrastructure for your
applications.
</p>
</div>
<div id="S4.SS4.SSS1.p2" class="ltx_para">
<p class="ltx_p">The installation of the baremetal system software starts in the base
folder (relative to the OpTiMSoC root)
<code class="ltx_verbatim ltx_font_typewriter">src/sw/system/baremetal-libs</code>.</p>
</div>
<div id="S4.SS4.SSS1.p3" class="ltx_para">
<p class="ltx_p">To perform the installation run:</p>
</div>
<div id="S4.SS4.SSS1.p4" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
$&gt; mkdir build
$&gt; cd build
$&gt; ../configure --prefix=$OPTIMSOC_INSTALLATION/systemsw/ --host=or1k-elf
$&gt; make
$&gt; make install
</pre>
</div>
</div>
<div id="S4.SS4.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">gzll Kernel and Libraries</h4>

<div id="S4.SS4.SSS2.p1" class="ltx_para">
<p class="ltx_p">(todo)</p>
</div>
</div>
</div>
<div id="S4.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.4.5 </span>Configuration</h3>

<div id="S4.SS5.p1" class="ltx_para">
<p class="ltx_p">After you installed the toolchain and compiled additional scripts, you
need to enable them in your system. When you followed the steps above
you will have to add the environment variables as (example for bash):</p>
</div>
<div id="S4.SS5.p2" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
# OpTiMSoC toolchain
export PATH=$OPTIMSOC_INSTALLATION/toolchain/bin:$OPTIMSOC_INSTALLATION/tools/utils:$<span class="ltx_text ltx_font_serif">{</span>PATH<span class="ltx_text ltx_font_serif">}</span>
export OPTIMSOC_TCL=$OPTIMSOC_INSTALLATION/tools/tcl
export PKG_CONFIG_PATH=$OPTIMSOC_INSTALLATION/systemsw/share/pkgconfig
</pre>
</div>
</div>
</div>
<div id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2.5 </span>Host Software</h2>

<div id="S5.p1" class="ltx_para">
<p class="ltx_p">The host software allows you to communicate with the system for
control and debugging/diagnosis. <code class="ltx_verbatim ltx_font_typewriter">liboptimsochost</code> is the basic
library, which also has a command line interface. A graphical user
interface complements this for easier visualization of the system. All
communication between the target and the host is done by a generic communication
library called &ldquo;GLIP&rdquo;.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p class="ltx_p">Before you start, set the <code class="ltx_verbatim ltx_font_typewriter">PKG_CONFIG_PATH</code> for the host software, which
will contain the glip and liboptimsochost pkgconfig files.</p>
</div>
<div id="S5.p3" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
export PKG_CONFIG_PATH=$OPTIMSOC_INSTALLATION/host/lib/pkgconfig:$PKG_CONFIG_PATH
</pre>
</div>
<div id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.5.1 </span>GLIP</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p class="ltx_p">GLIP is an independent project and the sources need to be obtained separately
from OpTiMSoC.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
$&gt; git clone https://github.com/tum-lis/glip.git
$&gt; cd glip
$&gt; ./autogen.sh
$&gt; mkdir build
$&gt; cd build
$&gt; ../configure --enable-cypressfx2 --enable-tcp --prefix=$OPTIMSOC_INSTALLATION/host
$&gt; make
$&gt; make install
</pre>
</div>
</div>
<div id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.5.2 </span>liboptimsochost</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p class="ltx_p">The library is found in <code class="ltx_verbatim ltx_font_typewriter">src/sw/host/liboptimsochost</code>. Some
tools are included with the library, the most important is the command
line interface <code class="ltx_verbatim ltx_font_typewriter">optimsoc_cli</code>. It can be used to communicate with
the OpTiMSoC debug system on the command line. Recently, a Python
scripting interface has been added. You will need the python
development libraries for this to work when enabled via
<code class="ltx_verbatim ltx_font_typewriter">--enable-python-interface</code>.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p class="ltx_p">Build, make and install:</p>
</div>
<div id="S5.SS2.p3" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
$&gt; mkdir build
$&gt; cd build
$&gt; ../configure --prefix=$OPTIMSOC_INSTALLATION/host --enable-python-interface
$&gt; make
$&gt; make install
</pre>
</div>
<div id="S5.SS2.p4" class="ltx_para">
<p class="ltx_p">Before proceeding you will need to set the correct paths:</p>
</div>
<div id="S5.SS2.p5" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
export LD_LIBRARY_PATH=$OPTIMSOC_INSTALLATION/host/lib:${LD_LIBRARY_PATH}
export PATH=$OPTIMSOC_INSTALLATION/host/bin:${PATH}
</pre>
</div>
</div>
<div id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.5.3 </span>Graphical User Interface</h3>

<div id="S5.SS3.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Prerequisites</h4>

<div id="S5.SS3.SSS1.p1" class="ltx_para">
<p class="ltx_p">For building you will need Qt:</p>
</div>
<div id="S5.SS3.SSS1.p2" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
$&gt; sudo apt-get install libqt4-dev
</pre>
</div>
<div id="S5.SS3.SSS1.p3" class="ltx_para">
<p class="ltx_p">In case you want to develop the GUI, install qtcreator:</p>
</div>
<div id="S5.SS3.SSS1.p4" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
$&gt; sudo apt-get install qtcreator
</pre>
</div>
</div>
<div id="S5.SS3.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">Building</h4>

<div id="S5.SS3.SSS2.p1" class="ltx_para">
<p class="ltx_p">The graphical user interface resides in
<code class="ltx_verbatim ltx_font_typewriter">src/sw/host/optimsocgui</code>. We use cmake here as it better
integrates with the Qt toolchain (which is used for the GUI).</p>
</div>
<div id="S5.SS3.SSS2.p2" class="ltx_para">
<p class="ltx_p">To build it:</p>
</div>
<div id="S5.SS3.SSS2.p3" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
$&gt; mkdir build
$&gt; cd build
$&gt; cmake -DCMAKE_INSTALL_PREFIX:PATH=$OPTIMSOC_INSTALLATION/host ..
$&gt; make
$&gt; make install
</pre>
</div>
<div id="S5.SS3.SSS2.p4" class="ltx_para">
<p class="ltx_p">Afterwards you will find <code class="ltx_verbatim ltx_font_typewriter">optimsocgui</code> in
<code class="ltx_verbatim ltx_font_typewriter">src/sw/host/optimsocgui/bin</code>.</p>
</div>
</div>
</div>
</div>
<div id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2.6 </span>ZTEX Tools</h2>

<div id="S6.p1" class="ltx_para">
<p class="ltx_p">In case you are running the bitstreams on the FPGA you will need the
ZTEX toolchain as it can be downloaded at <a href="http://www.ztex.de" title="" class="ltx_ref ltx_url"><span class="ltx_text ltx_font_typewriter">http://www.ztex.de</span></a>. We
will in the following assume you downloaded it and unpacked it to
<code class="ltx_verbatim ltx_font_typewriter">/opt/ztex/</code> so that the folder <code class="ltx_verbatim ltx_font_typewriter">/opt/ztex/java</code> exists. You
will need to set the path accordingly:</p>
</div>
<div id="S6.p2" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
export PATH=/opt/ztex/bin:/opt/ztex/java/FWLoader:$<span class="ltx_text ltx_font_serif">{</span>PATH<span class="ltx_text ltx_font_serif">}</span>
</pre>
</div>
<div id="S6.p3" class="ltx_para">
<p class="ltx_p">Furthermore you will need the small device compiler <code class="ltx_verbatim ltx_font_typewriter">sdcc</code>.</p>
</div>
</div>
<div id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2.7 </span>SystemC, Verilator and SystemC Libraries</h2>

<div id="S7.p1" class="ltx_para">
<p class="ltx_p">SystemC<a href="#optimsoc-doc-footnote-3"><sup>3</sup></a> is used as simulation
library for both full system simulation based on Verilator and in
future for abstracted simulations. In case you want to use either of
them, you will therefore need to download, compile and install
SystemC.</p>
</div>
<div id="S7.p2" class="ltx_para">
<p class="ltx_p">In case you want to run the Verilator-based simulation examples or
develop software using the Verilator-based simulation, you will need
to download and compile Verilator too.</p>
</div>
<div id="S7.p3" class="ltx_para">
<p class="ltx_p">In the following the installation to <code class="ltx_verbatim ltx_font_typewriter">/opt</code> is assumed, change
the folder if necessary.</p>
</div>
<div id="S7.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.7.1 </span>SystemC</h3>

<div id="S7.SS1.p1" class="ltx_para">
<p class="ltx_p">In case you already have SystemC installed (e.g., in the latest
version 2.3.1), you simply need to set the <code class="ltx_verbatim ltx_font_typewriter">PKG_CONFIG_PATH</code>
properly to where the <code class="ltx_verbatim ltx_font_typewriter">systemc.pc</code> file is found. In the latest
version this is for example:</p>
</div>
<div id="S7.SS1.p2" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:$SYSTEMC/lib-linux64/pkgconfig
</pre>
</div>
<div id="S7.SS1.p3" class="ltx_para">
<p class="ltx_p">If you don&rsquo;t have SystemC installed, first you need to register at the
SystemC website and download the SystemC package
(<code class="ltx_verbatim ltx_font_typewriter">systemc-2.3.1.tgz</code>). For installation create the base folder
and build directory:</p>
</div>
<div id="S7.SS1.p4" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
$&gt; sudo mkdir /opt/systemc
$&gt; sudo mkdir /opt/systemc/2.3.1
$&gt; sudo mkdir /opt/systemc/build
</pre>
</div>
<div id="S7.SS1.p5" class="ltx_para">
<p class="ltx_p">Copy the gzip file from above to the build dir, become superuser, move
there and extract it:</p>
</div>
<div id="S7.SS1.p6" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
$&gt; sudo cp systemc-2.3.1.tgz /opt/systemc/build
$&gt; cd /opt/systemc/build
$&gt; sudo tar -xzf systemc-2.3.1.tgz
</pre>
</div>
<div id="S7.SS1.p7" class="ltx_para">
<p class="ltx_p">Create a build object directory, configure in there, build, install,
done!</p>
</div>
<div id="S7.SS1.p8" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">$&gt; cd systemc-2.3.1
$&gt; sudo mkdir objdir
$&gt; sudo cd objdir
$&gt; sudo ../configure --prefix=/opt/systemc/2.3.1
$&gt; sudo make
$&gt; sudo make install
</pre>
</div>
<div id="S7.SS1.p9" class="ltx_para">
<p class="ltx_p">You will now find SystemC in <code class="ltx_verbatim ltx_font_typewriter">/opt/systemc/2.3.1</code> and need to set
<code class="ltx_verbatim ltx_font_typewriter">PKG_CONFIG_PATH</code> as described above.</p>
</div>
</div>
<div id="S7.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.7.2 </span>Verilator</h3>

<div id="S7.SS2.p1" class="ltx_para">
<p class="ltx_p">First clone the Verilator repository in <code class="ltx_verbatim ltx_font_typewriter">/opt</code>.</p>
</div>
<div id="S7.SS2.p2" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
$&gt; cd /opt
$&gt; sudo git clone http://git.veripool.org/git/verilator
</pre>
</div>
<div id="S7.SS2.p3" class="ltx_para">
<p class="ltx_p">Switch to the Verilator directory, prepare the build in place and make:</p>
</div>
<div id="S7.SS2.p4" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
$&gt; sudo -s
$&gt; cd verilator
$&gt; sudo aclocal
$&gt; autoconf
$&gt; ./configure
$&gt; make
$&gt; exit
</pre>
</div>
</div>
<div id="S7.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.7.3 </span>OpTiMSoC SystemC library</h3>

<div id="S7.SS3.p1" class="ltx_para">
<p class="ltx_p">The OpTiMSoC SystemC library contains SystemC modules for Debugging of
Verilated Systems, Simulations and other. It can be found in
<code class="ltx_verbatim ltx_font_typewriter">src/sysc/</code>. The build is identical to the other libraries</p>
</div>
<div id="S7.SS3.p2" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
$&gt; ./autogen.sh
$&gt; mkdir build
$&gt; cd build
$&gt; ../configure --prefix=$OPTIMSOC_INSTALLATION/sysc
$&gt; make
$&gt; make install
</pre>
</div>
<div id="S7.SS3.p3" class="ltx_para">
<p class="ltx_p">When SystemC is not found, make sure <code class="ltx_verbatim ltx_font_typewriter">PKG_CONFIG_PATH</code> is
correctly set.</p>
</div>
</div>
<div id="S7.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.7.4 </span>Configuration</h3>

<div id="S7.SS4.p1" class="ltx_para">
<p class="ltx_p">You will need the following environment variables (e.g., in bash):</p>
</div>
<div id="S7.SS4.p2" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
# SystemC environment
export SYSTEMC=/opt/systemc/2.3.0
# Verilator environment
export VERILATOR_ROOT=/opt/verilator
export PATH=$<span class="ltx_text ltx_font_serif">{</span>VERILATOR_ROOT<span class="ltx_text ltx_font_serif">}</span>/bin:$<span class="ltx_text ltx_font_serif">{</span>PATH<span class="ltx_text ltx_font_serif">}</span>
</pre>
</div>
</div>
</div>
<div id="S8" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2.8 </span>Configuration Summary</h2>

<div id="S8.p1" class="ltx_para">
<p class="ltx_p">Check that you have the following environment variables set at this
point (or a subset depending on your requirements):</p>
</div>
<div id="S8.p2" class="ltx_para">
<pre class="ltx_verbatim ltx_font_typewriter">
export LISNOC=<em class="ltx_emph">/path/to/lisnoc/clone</em>
export LISNOC_RTL=$<span class="ltx_text ltx_font_serif">{</span>LISNOC<span class="ltx_text ltx_font_serif">}</span>/rtl
export OPTIMSOC=<em class="ltx_emph">/path/to/optimsoc/clone</em>
export OPTIMSOC_RTL=$<span class="ltx_text ltx_font_serif">{</span>OPTIMSOC<span class="ltx_text ltx_font_serif">}</span>/src/rtl
export OPTIMSOC_SYSC=$<span class="ltx_text ltx_font_serif">{</span>OPTIMSOC<span class="ltx_text ltx_font_serif">}</span>/src/sysc
# Your OpTiMSoC installation path
export OPTIMSOC_INSTALLATION=/opt/optimsoc
# OpTiMSoC toolchain
export PATH=/opt/openrisc/toolchain/bin:$<span class="ltx_text ltx_font_serif">{</span>OPTIMSOC_INSTALLATION<span class="ltx_text ltx_font_serif">}</span>/tools/utils:$<span class="ltx_text ltx_font_serif">{</span>PATH<span class="ltx_text ltx_font_serif">}</span>
export OPTIMSOC_NEWLIB=$<span class="ltx_text ltx_font_serif">{</span>OPTIMSOC_INSTALLATION<span class="ltx_text ltx_font_serif">}</span>/newlib/
# TCL scripting
export OPTIMSOC_TCL=$<span class="ltx_text ltx_font_serif">{</span>OPTIMSOC_INSTALLATION<span class="ltx_text ltx_font_serif">}</span>/tools/tcl
# SystemC environment
export PKG_CONFIG_PATH=$PKG_CONFIG_PATH:$SYSTEMC/lib-linux64/pkgconfig
# Verilator environment
export VERILATOR_ROOT=/opt/verilator
export PATH=$<span class="ltx_text ltx_font_serif">{</span>VERILATOR_ROOT<span class="ltx_text ltx_font_serif">}</span>/bin:$<span class="ltx_text ltx_font_serif">{</span>PATH<span class="ltx_text ltx_font_serif">}</span>
# System software
export PKG_CONFIG_PATH=$<span class="ltx_text ltx_font_serif">{</span>OPTIMSOC_INSTALLATION<span class="ltx_text ltx_font_serif">}</span>/systemsw/share/pkgconfig:$PKG_CONFIG_PATH
# Host library, tools and GUI
export PKG_CONFIG_PATH=$<span class="ltx_text ltx_font_serif">{</span>OPTIMSOC_INSTALLATION<span class="ltx_text ltx_font_serif">}</span>/host/lib/pkgconfig:$PKG_CONFIG_PATH
export LD_LIBRARY_PATH=$<span class="ltx_text ltx_font_serif">{</span>OPTIMSOC_INSTALLATION<span class="ltx_text ltx_font_serif">}</span>/host/lib:$<span class="ltx_text ltx_font_serif">{</span>LD_LIBRARY_PATH<span class="ltx_text ltx_font_serif">}</span>
export PATH=$<span class="ltx_text ltx_font_serif">{</span>OPTIMSOC_INSTALLATION<span class="ltx_text ltx_font_serif">}</span>/host/bin:$<span class="ltx_text ltx_font_serif">{</span>PATH<span class="ltx_text ltx_font_serif">}</span>
</pre>
</div>
</div>
<div id="S9" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2.9 </span>Upgrade from rel-20130620</h2>

<div id="S9.p1" class="ltx_para">
<ul id="I1" class="ltx_itemize">
<li id="I1.i1" class="ltx_item">
<div id="I1.i1.p1" class="ltx_para">
<p class="ltx_p">The in-place installation has been changed to a unified
installation tree. You should reinstall.</p>
</div>
</li>
<li id="I1.i2" class="ltx_item">
<div id="I1.i2.p1" class="ltx_para">
<p class="ltx_p">The newlib has been removed.</p>
</div>
</li>
<li id="I1.i3" class="ltx_item">
<div id="I1.i3.p1" class="ltx_para">
<p class="ltx_p">The system software structure has been changed. We removed the
distinction between distributed and shared memory. Furthermore we
have baremetal and virtualapps here also. You need to rebuild.</p>
</div>
</li>
<li id="I1.i4" class="ltx_item">
<div id="I1.i4.p1" class="ltx_para">
<p class="ltx_p">The TCL interface has been added. Set <code class="ltx_verbatim ltx_font_typewriter">OPTIMSOC_TCL</code> as
described above.</p>
</div>
</li>
<li id="I1.i5" class="ltx_item">
<div id="I1.i5.p1" class="ltx_para">
<p class="ltx_p">The previous liboptimsochost examples are now part of the
distribution as &ldquo;tools&rdquo;. Please rebuild the library.</p>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<hr class="optimsoc-doc-sep-footnotes">
<div class="optimsoc-doc-footnote-full" id="optimsoc-doc-footnote-2">
<sup>2</sup>http://www.git-scm.org</div>
<div class="optimsoc-doc-footnote-full" id="optimsoc-doc-footnote-3">
<sup>3</sup><a href="http://www.systemc.org" title="" class="ltx_ref ltx_url"><span class="ltx_text ltx_font_typewriter">http://www.systemc.org</span></a>
</div>
</div>
